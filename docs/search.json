[{"path":"https://github.com/Holdols/genstats/articles/GWAS.html","id":"simple-association-analysis","dir":"Articles","previous_headings":"","what":"Simple association analysis","title":"GWAS","text":"Using method described gen_sim simulate genetic data, can use data visualise association studies methods prediction. artcle going cover use theory method GWAS. GWAS, stands genome-wide association studies method used , name implies, association studies. Meaning based large quantities genetic data like know places genome critical developing given sickness trait. GWAS simple terms linear regression SNP tries estimate casual effect mutation probability trait sickenes. GWAS can therefore written linear regression: \\[ Y \\sim \\mathcal{N}(X\\beta,\\Sigma) \\] \\(Y\\) denotes actual traits subjects. \\(Y\\) 1 subject sickness/trait zero . X genetic data, generated gen_sim() function, equal G.","code":""},{"path":"https://github.com/Holdols/genstats/articles/GWAS.html","id":"gwas-using-logistic-regression","dir":"Articles","previous_headings":"","what":"GWAS using logistic regression","title":"GWAS","text":"default function GWAS() use linear regression. concept \\(Y\\) binary variable open door models. simple one logistic regression uses logit function activation function transform linearregression probability curve. model also implemented GWAs function can accessed setting ‘logreg = TRUE’. Though wil show difference result logistic liner regression minimal.","code":""},{"path":"https://github.com/Holdols/genstats/articles/GWAS.html","id":"using-gwas","dir":"Articles","previous_headings":"","what":"Using GWAS","title":"GWAS","text":"following tutorial file used generated using method described gen_sim. First load data. simulated \\(100,000\\times100,000\\) datapoints using ‘fam=FALSE’. family structure unimportant since using trait subject. Know estimate casual effect SNP using bonferronni correction, ans since \\(100,000\\) indiviuals use \\(p=\\frac{0.05}{100000}\\).  see catches extreme cases. Looking powerplot makes lot sense  [][GWAS_manhattan.jpg) [][GWAS_scatter.jpg) [][GWAS_power.jpg)","code":"library(genstats) library(bigsnpr) #> Warning: package 'bigsnpr' was built under R version 4.0.5 #> Loading required package: bigstatsr #> Warning: package 'bigstatsr' was built under R version 4.0.5 #> Registered S3 methods overwritten by 'tibble': #>   method     from   #>   format.tbl pillar #>   print.tbl  pillar library(dplyr) #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union  genetic_data = snp_attach('genetic_data.rds') G=genetic_data$genotypes y =  genetic_data$fam %>% select('pheno_0')  beta = genetic_data$map$beta gwas_summary = GWAS(G=G, y=y[[1]], p=0.05/100000, logreg = FALSE, ncores=3) #> Warning: 'y.train' is composed of only two different levels. head(gwas_summary) #>          estim     std.err      score     p_vals causal_estimate #> 1 -0.005987535 0.004443138 -1.3475914 0.17782039               0 #> 2 -0.006664683 0.003534050 -1.8858483 0.05934436               0 #> 3 -0.009804117 0.007506549 -1.3060750 0.19155709               0 #> 4 -0.002721957 0.004071671 -0.6685111 0.50382286               0 #> 5 -0.003998108 0.003511870 -1.1384556 0.25495758               0 #> 6  0.005265846 0.008903985  0.5914033 0.55426363               0 scatter_plot(gwas_summary, beta) power_plot(gwas_summary, beta)"},{"path":"https://github.com/Holdols/genstats/articles/LT-FH.html","id":"using-ltfh","dir":"Articles","previous_headings":"","what":"Using LTFH","title":"LT-FH","text":"following tutorial file used generated using method described vignette(“gen_sim”). First load data. simulated \\(1e^3\\times1e^3\\) datapoints using two siblings. following 100 SNPs casual effect. data used show case method illustrate package can used. methods used actual statistical analysis recomend simulating \\(1e^5\\times1e^5\\) datapoints 500-1000 casual SNPs. practical reasons apple show case analysis. included pictures illustrate results \\(1e^5\\times1e^5\\) data. know run LT-FH can see get estimates subjects genetic liabilities new column. estimated genetic liabilities can now used wanted. using target vector linear regression order estimate causual effect SNP. table se result association analysis, can se SNP’s estimated casual. using bonferronni correction lower amont false positive causal SNP. since \\(1e^3\\) indiviuals use \\(p=\\frac{0.05}{1000}=5e^{-5}\\). can se result ","code":"# The rds file containing simulated data is loaded genetic_data = snp_attach('genetic_data.rds')  # We save the genotypes and beta for later use G = genetic_data$genotypes beta = genetic_data$map$beta LTFH_est = LTFH(data = genetic_data, n_sib = 2) head(LTFH_est) #>   FID      l_f_0      l_g_0 pheno_0      l_f_p1     l_g_p1 pheno_p1      l_f_p2 #> 1   1 -0.3384807 -0.7064320       0  0.86542968 -0.4871935        0  0.10331741 #> 2   2  1.4324619  0.4944826       0  0.77872081  1.1045429        0  0.60545412 #> 3   3 -1.0801217 -0.3403101       0 -0.09001458  1.0320972        0 -0.22832639 #> 4   4  1.2669931  0.5825709       0 -1.24249284 -0.3447710        0  0.86003095 #> 5   5  0.3125711  1.0115020       0  1.74724276  1.3767706        1  0.87617390 #> 6   6 -0.5124047  0.1266217       0 -0.42144219 -0.1451376        0 -0.02902428 #>       l_g_p2 pheno_p2     l_f_s3     l_g_s3 pheno_s3      l_f_s4      l_g_s4 #> 1  0.2801320        0  0.5112359  0.2131810        0 -1.50060122 -0.11247134 #> 2  0.4630299        0  2.0563382  1.3112339        1  1.35933840  1.00005536 #> 3 -0.7587923        0 -0.1088843 -0.1558196        0 -0.72531820 -0.79113094 #> 4  1.2059687        0  1.5115114  0.4552358        0  0.45513811  0.08464925 #> 5  0.3278623        0  0.4358816  0.9360237        0  0.70031543  1.14029948 #> 6 -0.6010279        0 -0.4068985 -0.5806311        0  0.09545961  0.90836585 #>   pheno_s4  l_g_est_0 #> 1        0 -0.1371848 #> 2        0  0.3015333 #> 3        0 -0.1371848 #> 4        0 -0.1371848 #> 5        0  0.3342522 #> 6        0 -0.1371848 LTFH_summary = GWAS(G = G, y = LTFH_est$l_g_0, p = 5e-5, logreg = FALSE, ncores = 3) head(LTFH_summary) #>          estim    std.err      score      p_vals causal_estimate #> 1  0.002007187 0.01383549  0.1450753 0.884654371               0 #> 2 -0.010628664 0.01100513 -0.9657913 0.334171958               0 #> 3  0.003329657 0.02337451  0.1424482 0.886728893               0 #> 4 -0.041767248 0.01267104 -3.2962767 0.000983169               0 #> 5  0.010018953 0.01093488  0.9162381 0.359564110               0 #> 6 -0.026468634 0.02772285 -0.9547587 0.339722810               0"},{"path":"https://github.com/Holdols/genstats/articles/LT-FH.html","id":"outcome-for-realistic-data","dir":"Articles","previous_headings":"","what":"Outcome for realistic data","title":"LT-FH","text":"give results association analysis data set \\(1e^5\\times1e^5\\) datapoint. process getting result shown course used p-value \\(p=\\frac{0.05}{100000}=5e^{-7}\\). first plot shown manhattan plot. plot illustrates well analysis differentiate casual non causual snp. Two horisontal lines drawn illustrating tresholds p-value. can se choosing use conservative method bonferronni correction describe data better. Comparing result og GWAS without using estimated liabilities se LTFH clearly performs better.  can also illustrated using scatterplot. see good finding estimates af extreme effects, though much difficult association analysis around middle. Agian method much performs normal vignette(“GWAS”).  last include plower plot show case able estimate smaller causal effects. simply power test !","code":"manhattan_plot(gwas_summary = LTFH_summary, beta = beta, treshold = c(5e-7, 0.05)) scatter_plot(gwas_summary = LTFH_summary, beta = beta) power_plot(gwas_summary = LTFH_summary, beta = beta)"},{"path":"https://github.com/Holdols/genstats/articles/Simulation.html","id":"simulation-without-family-history","dir":"Articles","previous_headings":"","what":"Simulation without family history","title":"Simulating data","text":"package offers different methods simulating data. Fist going show simply get genotypes N subjects genetic ful liabilities. using small scale test, recomend data used actual statistc analysis least \\(10,000\\times10,000\\) datapoints simulated. Now exist rds file working directoy data, load. Looking data see file contains list. can find genotypes (G), liabilities (fam) information SNP (map). Using function dist_check() can see distribution full liabilities expected, standard normal. using af small testset expect mean variance approximately 0 1. can see mean variance correct qqplot resembles normal distribution. now possible perfom GWAS association analysis use genotypes prediction.","code":"gen_sim('simple_sim_example', N=1000, M=1000, C=50, block_size = 100, fam=FALSE) simple_data = snp_attach('simple_sim_example.rds') simple_data simple_data$G[(1:5),(1:5)] simple_data$fam simple_data$map dist_check(simple_data)"},{"path":"https://github.com/Holdols/genstats/articles/Simulation.html","id":"simulation-with-family-history","dir":"Articles","previous_headings":"","what":"Simulation with family history","title":"Simulating data","text":"Simulation family history similar simulating without. see bit family history, values family member subject. can check distrubition full liability using function . Now data ready analysied using LTFH used predictive analysis.","code":"gen_sim('family_sim_example', N=1000, M=1000, C=50, block_size = 100, n_sib=2) family_data = snp_attach('family_sim_example.rds') family_data$fam dist_check(simple_data)"},{"path":"https://github.com/Holdols/genstats/articles/Simulation.html","id":"note-on-parrellelisation-block-size-and-memory-use-","dir":"Articles","previous_headings":"Simulation with family history","what":"Note on parrellelisation, block size and memory use.","title":"Simulating data","text":"functions simualation optimized parallelization available cores standard. Depending computer running simulation, block size amount RAM take lot memory computer, user specified amount cores preffered, can specified running options(mc.cores = core_amount) core_amount amount cores available R. Furthermore depending specified block size R need allocate quite bit memory, can create error computers depending RAM, relevant check https://www.rdocumentation.org/packages/utils/versions/3.6.2/topics/memory.size. doesn’t fix error, decreasing block size /amount cores recommended.","code":""},{"path":"https://github.com/Holdols/genstats/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Louise Mølgaard Laustsen. Author. Ole Sahlholdt Hansen. Author. Holdols. Maintainer.","code":""},{"path":"https://github.com/Holdols/genstats/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Laustsen L, Hansen O (2022). genstats: Analyse genetic data. R package version 0.0.0.9000, https://holdols.github.io/genstats.","code":"@Manual{,   title = {genstats: Analyse genetic data},   author = {Louise Mølgaard Laustsen and Ole Sahlholdt Hansen},   year = {2022},   note = {R package version 0.0.0.9000},   url = {https://holdols.github.io/genstats}, }"},{"path":"https://github.com/Holdols/genstats/index.html","id":"genstats","dir":"","previous_headings":"","what":"Analyse genetic data","title":"Analyse genetic data","text":"genstats provide easy access tools statistical analysis genetic data. Genetic data difficult come , provides informative basis statistical use. therefore assumptions provided method simulating genetic data can used association analysis predictive statistics. package provides standard methods association analysis GWAS LT-FH. Though structure simulated data easy use comnination dplyr therefor easy implement methods. packages uses method LT-FH described Hujoel, M.L.., Gazal, S., Loh, PR. et al.. Link article found Biblography. package developed part bachelor’s program data science Aarhus University.","code":""},{"path":"https://github.com/Holdols/genstats/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Analyse genetic data","text":"can install development version genstats GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"Holdols/genstats\")"},{"path":"https://github.com/Holdols/genstats/index.html","id":"biblography","dir":"","previous_headings":"","what":"Biblography","title":"Analyse genetic data","text":"Hujoel, M.L.., Gazal, S., Loh, PR. et al. Liability threshold modeling case–control status family history disease increases association power. Nat Genet 52, 541–547 (2020). https://doi.org/10.1038/s41588-020-0613-6” package uses functions methods bigsnpr: https://privefl.github.io/bigsnpr/ bigstatsr: https://privefl.github.io/bigstatsr/index.html Please visit site information data stored","code":""},{"path":"https://github.com/Holdols/genstats/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 genstats authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://github.com/Holdols/genstats/reference/assign_snp.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign SNPs for the subject — assign_snp","title":"Assign SNPs for the subject — assign_snp","text":"Helper function gen_sim()","code":""},{"path":"https://github.com/Holdols/genstats/reference/assign_snp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign SNPs for the subject — assign_snp","text":"","code":"assign_snp(G1, G2, N = 1e+05, block_size = 1000)"},{"path":"https://github.com/Holdols/genstats/reference/assign_snp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign SNPs for the subject — assign_snp","text":"G1 SNPs parent1. G2 SNPs parent2. N Amount subjects. block_size Size FBM processed iteration.","code":""},{"path":"https://github.com/Holdols/genstats/reference/assign_snp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign SNPs for the subject — assign_snp","text":"Matrix simulated SNPs.","code":""},{"path":"https://github.com/Holdols/genstats/reference/beta_func.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate beta — beta_func","title":"Simulate beta — beta_func","text":"function simulates casual effect SNP. S ince C causual SNPs distribution beta sampled normal distribution zero mean variance heritability divided casual SNPs.","code":""},{"path":"https://github.com/Holdols/genstats/reference/beta_func.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate beta — beta_func","text":"","code":"beta_func(M = 1e+05, h2 = 0.5, C = 1000)"},{"path":"https://github.com/Holdols/genstats/reference/beta_func.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate beta — beta_func","text":"M size beta vector. h2 heritability trait. C Amount causal SNPs.","code":""},{"path":"https://github.com/Holdols/genstats/reference/beta_func.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate beta — beta_func","text":"vector size M containing value rnorm(1, 0, sqrt(h2/C)) C random places.","code":""},{"path":"https://github.com/Holdols/genstats/reference/calc_distribution.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculates the constants parameters for the conditional distribution belonging to each\r\nliabilities of the multivariate gaussian.\r\n\r\nHelper function for gibb_sampl() — calc_distribution","title":"Calculates the constants parameters for the conditional distribution belonging to each\r\nliabilities of the multivariate gaussian.\r\n\r\nHelper function for gibb_sampl() — calc_distribution","text":"form  mu_mult = \\(\\Sigma_{12}\\Sigma_{22}^{-1}\\mu _2\\)  sigma_bar = \\(\\Sigma_{11} - \\Sigma_{12}\\Sigma_{22}^{-1}\\Sigma_{21}\\)  used helper function LTFH.","code":""},{"path":"https://github.com/Holdols/genstats/reference/calc_distribution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculates the constants parameters for the conditional distribution belonging to each\r\nliabilities of the multivariate gaussian.\r\n\r\nHelper function for gibb_sampl() — calc_distribution","text":"","code":"calc_distribution(sigma)"},{"path":"https://github.com/Holdols/genstats/reference/calc_distribution.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculates the constants parameters for the conditional distribution belonging to each\r\nliabilities of the multivariate gaussian.\r\n\r\nHelper function for gibb_sampl() — calc_distribution","text":"sigma covariance matrix.","code":""},{"path":"https://github.com/Holdols/genstats/reference/calc_distribution.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculates the constants parameters for the conditional distribution belonging to each\r\nliabilities of the multivariate gaussian.\r\n\r\nHelper function for gibb_sampl() — calc_distribution","text":"list containing sigma_bar mu_mult liability.","code":""},{"path":"https://github.com/Holdols/genstats/reference/calc_distribution.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculates the constants parameters for the conditional distribution belonging to each\r\nliabilities of the multivariate gaussian.\r\n\r\nHelper function for gibb_sampl() — calc_distribution","text":"","code":"calc_distribution(get_cov(0.5)) #> Error in calc_distribution(get_cov(0.5)): could not find function \"calc_distribution\""},{"path":"https://github.com/Holdols/genstats/reference/calc_full_liabil.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate full liabilities from envirromental and genetic liabilities — calc_full_liabil","title":"Calculate full liabilities from envirromental and genetic liabilities — calc_full_liabil","text":"Calculate full liabilities envirromental genetic liabilities","code":""},{"path":"https://github.com/Holdols/genstats/reference/calc_full_liabil.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate full liabilities from envirromental and genetic liabilities — calc_full_liabil","text":"","code":"calc_full_liabil(liabilities, n_sib = 0)"},{"path":"https://github.com/Holdols/genstats/reference/calc_full_liabil.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate full liabilities from envirromental and genetic liabilities — calc_full_liabil","text":"liabilities Liabilities subject family n_sib Amount siblings K prevalance trait","code":""},{"path":"https://github.com/Holdols/genstats/reference/calc_full_liabil.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate full liabilities from envirromental and genetic liabilities — calc_full_liabil","text":"Matrix containing full lliabilities subject","code":""},{"path":"https://github.com/Holdols/genstats/reference/calc_phen.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate phentypes from from envirromental and genetic liabilities — calc_phen","title":"Calculate phentypes from from envirromental and genetic liabilities — calc_phen","text":"Calculate phentypes envirromental genetic liabilities","code":""},{"path":"https://github.com/Holdols/genstats/reference/calc_phen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate phentypes from from envirromental and genetic liabilities — calc_phen","text":"","code":"calc_phen(liabilities, K = 0.05, n_sib = 0)"},{"path":"https://github.com/Holdols/genstats/reference/calc_phen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate phentypes from from envirromental and genetic liabilities — calc_phen","text":"liabilities Liabilities subject family K prevalance trait n_sib Amount siblings","code":""},{"path":"https://github.com/Holdols/genstats/reference/calc_phen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate phentypes from from envirromental and genetic liabilities — calc_phen","text":"Matrix containing phenotypes subject","code":""},{"path":"https://github.com/Holdols/genstats/reference/collapse_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculates the sum of colunms in a tibble for each person and value — collapse_data","title":"Calculates the sum of colunms in a tibble for each person and value — collapse_data","text":"Helper function gen_sim()","code":""},{"path":"https://github.com/Holdols/genstats/reference/collapse_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculates the sum of colunms in a tibble for each person and value — collapse_data","text":"","code":"collapse_data(data, n_sib)"},{"path":"https://github.com/Holdols/genstats/reference/collapse_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculates the sum of colunms in a tibble for each person and value — collapse_data","text":"data Tibble colunms sum . n_sibs Amount siblings.","code":""},{"path":"https://github.com/Holdols/genstats/reference/collapse_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculates the sum of colunms in a tibble for each person and value — collapse_data","text":"Collapsed tibble.","code":""},{"path":"https://github.com/Holdols/genstats/reference/control_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plotting estimated liabilities agianst distribution — control_plot","title":"Plotting estimated liabilities agianst distribution — control_plot","text":"recreation figure 1. b Hujoel et al. (2020)","code":""},{"path":"https://github.com/Holdols/genstats/reference/control_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plotting estimated liabilities agianst distribution — control_plot","text":"","code":"control_plot(phenos, h2, col = \"black\")"},{"path":"https://github.com/Holdols/genstats/reference/control_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plotting estimated liabilities agianst distribution — control_plot","text":"h2 heritability trait. pheno Vector containing phenotypes.","code":""},{"path":"https://github.com/Holdols/genstats/reference/control_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plotting estimated liabilities agianst distribution — control_plot","text":"Plot estimated liabilities.","code":""},{"path":"https://github.com/Holdols/genstats/reference/create_fbm.html","id":null,"dir":"Reference","previous_headings":"","what":"Create and save file backed matrix (FBM) — create_fbm","title":"Create and save file backed matrix (FBM) — create_fbm","text":"Helper function gen_sim()","code":""},{"path":"https://github.com/Holdols/genstats/reference/create_fbm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create and save file backed matrix (FBM) — create_fbm","text":"","code":"create_fbm(filename, N, M)"},{"path":"https://github.com/Holdols/genstats/reference/create_fbm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create and save file backed matrix (FBM) — create_fbm","text":"filename Filename FBM rds file. N Amount subjects. M Amount SNPs.","code":""},{"path":"https://github.com/Holdols/genstats/reference/create_fbm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create and save file backed matrix (FBM) — create_fbm","text":"FBM.","code":""},{"path":"https://github.com/Holdols/genstats/reference/dist_check.html","id":null,"dir":"Reference","previous_headings":"","what":"Check distribution of liabilities — dist_check","title":"Check distribution of liabilities — dist_check","text":"function calculates mean variance full liability returned gen_sim(). assumption simulation based full liability normaly distributed. function therefore also returns qqplot full liability. purpose function provide certainty simulated data correct.","code":""},{"path":"https://github.com/Holdols/genstats/reference/dist_check.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check distribution of liabilities — dist_check","text":"","code":"dist_check(data)"},{"path":"https://github.com/Holdols/genstats/reference/dist_check.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check distribution of liabilities — dist_check","text":"data List generated gen_sim.","code":""},{"path":"https://github.com/Holdols/genstats/reference/dist_check.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check distribution of liabilities — dist_check","text":"Creates qqplot, mean sample variance liability family.","code":""},{"path":"https://github.com/Holdols/genstats/reference/dist_check.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check distribution of liabilities — dist_check","text":"","code":"dist_check(snp_attach(\"test.rds\")) #> Error in snp_attach(\"test.rds\"): could not find function \"snp_attach\""},{"path":"https://github.com/Holdols/genstats/reference/estimate_conf.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimates liabilities for every configuration in data — estimate_conf","title":"Estimates liabilities for every configuration in data — estimate_conf","text":"Helper function LTFH()","code":""},{"path":"https://github.com/Holdols/genstats/reference/estimate_conf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimates liabilities for every configuration in data — estimate_conf","text":"","code":"estimate_conf(unique_comb, n_sib = 0, K = 0.5, h2 = 0.5)"},{"path":"https://github.com/Holdols/genstats/reference/estimate_conf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimates liabilities for every configuration in data — estimate_conf","text":"unique_comb Configuration phenotypes estimate genetic liability . n_sib Amount siblings. K prevalance trait. h2 heritability trait.","code":""},{"path":"https://github.com/Holdols/genstats/reference/estimate_conf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimates liabilities for every configuration in data — estimate_conf","text":"Tibble estimated liabilities configuration.","code":""},{"path":"https://github.com/Holdols/genstats/reference/estimate_liabilities.html","id":null,"dir":"Reference","previous_headings":"","what":"Using phentoypes the function estimates full liabilities using LT-FH — estimate_liabilities","title":"Using phentoypes the function estimates full liabilities using LT-FH — estimate_liabilities","text":"Using phentoypes function estimates full liabilities using LT-FH","code":""},{"path":"https://github.com/Holdols/genstats/reference/estimate_liabilities.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Using phentoypes the function estimates full liabilities using LT-FH — estimate_liabilities","text":"","code":"estimate_liabilities(pheno, K = 0.05, n_sib = 0, h2 = 0.5)"},{"path":"https://github.com/Holdols/genstats/reference/estimate_liabilities.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Using phentoypes the function estimates full liabilities using LT-FH — estimate_liabilities","text":"pheno matrix containing phenotypes K prevalence trait n_sib Amount siblings h2 heritability","code":""},{"path":"https://github.com/Holdols/genstats/reference/estimate_liabilities.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Using phentoypes the function estimates full liabilities using LT-FH — estimate_liabilities","text":"Tibble containing phenotypes estimates individual family","code":""},{"path":"https://github.com/Holdols/genstats/reference/gen_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate genetic data — gen_sim","title":"Simulate genetic data — gen_sim","text":"function used simulate genetic data. Using parallelization function can simulate genotypes, liabilities without family structure. function return list information simulation can found. includes SNP casual effect , genetic full liabilities og subjects, parents siblings phenotypes. object can used develop test statistical analysis genetic data.","code":""},{"path":"https://github.com/Holdols/genstats/reference/gen_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate genetic data — gen_sim","text":"","code":"gen_sim(   filename,   beta = NULL,   MAF = NULL,   N = 1e+05,   M = 1e+05,   n_sib = 0,   K = 0.05,   h2 = 0.5,   C = 1000,   block_size = 1000,   fam = TRUE,   parallel_plan = \"multisession\" )"},{"path":"https://github.com/Holdols/genstats/reference/gen_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate genetic data — gen_sim","text":"filename Filename file backed matrix(FBM) rds file. beta Vector containing minor allele frequencies (MAF). NULL vector simulated N Amount subjects. M Amount SNPs. K prevalance trait. h2 heritability trait. C Amount causal SNP's. block_size Size FBM processed iteration. fam Boolean deciding simulation include family structure. parallel_plan Plan parallelization. See ?future::plan. n_sibs Amount siblings.","code":""},{"path":"https://github.com/Holdols/genstats/reference/gen_sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate genetic data — gen_sim","text":"rds file referring list containing FBM genotypes, generated SNP info information subject family liabilities.","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_all_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Using genetic and enviromental liabilities the function calculates phenotypes, full liabilites and estimates full liabilities using LT-FH — get_all_data","title":"Using genetic and enviromental liabilities the function calculates phenotypes, full liabilites and estimates full liabilities using LT-FH — get_all_data","text":"Using genetic enviromental liabilities function calculates phenotypes, full liabilites estimates full liabilities using LT-FH","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_all_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Using genetic and enviromental liabilities the function calculates phenotypes, full liabilites and estimates full liabilities using LT-FH — get_all_data","text":"","code":"get_all_data(data, K = 0.05, n_sib = 0, h2 = 0.5)"},{"path":"https://github.com/Holdols/genstats/reference/get_all_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Using genetic and enviromental liabilities the function calculates phenotypes, full liabilites and estimates full liabilities using LT-FH — get_all_data","text":"data Tibble containing information indiviual family's genetic enviromental liabilities K prevalence trait n_sib Amount siblings h2 heritability","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_all_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Using genetic and enviromental liabilities the function calculates phenotypes, full liabilites and estimates full liabilities using LT-FH — get_all_data","text":"Tibble containing information estimates individual family","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_cov.html","id":null,"dir":"Reference","previous_headings":"","what":"Create covariance matrix — get_cov","title":"Create covariance matrix — get_cov","text":"function returns covariance matrix multivariate normal distribution lg_subject, l_subject, l_parent1, l_parent2, l_sibling1, ... ,l_siblingN","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_cov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create covariance matrix — get_cov","text":"","code":"get_cov(h2, n_sib = 0)"},{"path":"https://github.com/Holdols/genstats/reference/get_cov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create covariance matrix — get_cov","text":"h2 heritability trait. n_sib Amount siblings.","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_cov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create covariance matrix — get_cov","text":"Covariance matrix datatype matrix.","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_cov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create covariance matrix — get_cov","text":"","code":"get_cov(0.5, n_sib = 2) #>      [,1] [,2] [,3] [,4] [,5] [,6] #> [1,] 0.50 0.50 0.25 0.25 0.25 0.25 #> [2,] 0.50 1.00 0.25 0.25 0.25 0.25 #> [3,] 0.25 0.25 1.00 0.00 0.25 0.25 #> [4,] 0.25 0.25 0.00 1.00 0.25 0.25 #> [5,] 0.25 0.25 0.25 0.25 1.00 0.25 #> [6,] 0.25 0.25 0.25 0.25 0.25 1.00"},{"path":"https://github.com/Holdols/genstats/reference/get_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Find start and and end index of FBM — get_index","title":"Find start and and end index of FBM — get_index","text":"Helper function gen_sim()","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find start and and end index of FBM — get_index","text":"","code":"get_index(i, block_size)"},{"path":"https://github.com/Holdols/genstats/reference/get_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find start and and end index of FBM — get_index","text":"Iteration loop. block_size Size FBM processed iteration.","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find start and and end index of FBM — get_index","text":"List start end index.","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_member.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate block of snps for each family member — get_member","title":"Simulate block of snps for each family member — get_member","text":"Helper function gen_sim()","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_member.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate block of snps for each family member — get_member","text":"","code":"get_member(i, beta, MAF, N = 1e+05, block_size = 1000)"},{"path":"https://github.com/Holdols/genstats/reference/get_member.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate block of snps for each family member — get_member","text":"Iteration loop. beta vector containing casual effect SNP. MAF vector containing minor allele frequencies. N Amount subjects. block_size Size FBM processed iteration.","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_member.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate block of snps for each family member — get_member","text":"List containing block simulated snps genetic liabilities","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_names.html","id":null,"dir":"Reference","previous_headings":"","what":"Adds a postfix to given names for each family member — get_names","title":"Adds a postfix to given names for each family member — get_names","text":"function serves help user generate wished columns names. function works well combination dplyr using argument contains select. requirements input string.","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_names.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adds a postfix to given names for each family member — get_names","text":"","code":"get_names(names, n_sib = 0, id = TRUE, parents = TRUE)"},{"path":"https://github.com/Holdols/genstats/reference/get_names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Adds a postfix to given names for each family member — get_names","text":"names Names values add postfix e.g. l_g. n_sib Amount siblings. id TRUE add postfix subject. parents TRUE add postfix parents.","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_names.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Adds a postfix to given names for each family member — get_names","text":"vector containing names family member.","code":""},{"path":"https://github.com/Holdols/genstats/reference/get_names.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Adds a postfix to given names for each family member — get_names","text":"","code":"get_names(c(\"l_g\", \"l_e\"), n_sib = 2) #>  [1] \"l_g_0\"  \"l_e_0\"  \"l_g_p1\" \"l_e_p1\" \"l_g_p2\" \"l_e_p2\" \"l_g_s3\" \"l_e_s3\" #>  [9] \"l_g_s4\" \"l_e_s4\""},{"path":"https://github.com/Holdols/genstats/reference/gibbs_sampl.html","id":null,"dir":"Reference","previous_headings":"","what":"Create LTFH estimations for a configuration. — gibbs_sampl","title":"Create LTFH estimations for a configuration. — gibbs_sampl","text":"function estimates genetic liability subject given configuration familiy members phenotype. phenotype given either 0 1 indicating family member trait/sickness. function uses Monte Carlo integration estimate conditional distribution.","code":""},{"path":"https://github.com/Holdols/genstats/reference/gibbs_sampl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create LTFH estimations for a configuration. — gibbs_sampl","text":"","code":"gibbs_sampl(   covmat,   phenos,   K = 0.05,   s_val = 0,   start_run = 500,   all_est = FALSE )"},{"path":"https://github.com/Holdols/genstats/reference/gibbs_sampl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create LTFH estimations for a configuration. — gibbs_sampl","text":"covmat covariance matrix. phenos binary vector containing phenotype family member form c(p_subject, p_parent1, p_parent2, p_sibling1, ... ,p_siblingN) p_familymember binary value (1 2). K prevalance trait. False truncation applied. s_val starting value liabilities. start_run Number iterations convergence expected. all_est TRUE return value iteration burn , else return mean values.","code":""},{"path":"https://github.com/Holdols/genstats/reference/gibbs_sampl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create LTFH estimations for a configuration. — gibbs_sampl","text":"vector containing LTFH estimate liabilities form c(genetic_liability_subject, liability_subject, liability_parent1, liability_parent2, liability_sibling1, ..., liability_siblingN).","code":""},{"path":"https://github.com/Holdols/genstats/reference/gibbs_sampl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create LTFH estimations for a configuration. — gibbs_sampl","text":"","code":"LTFH(get_cov(0.5, n_sib = 1), c(1, 1, 0, 0)) #> Error: $ operator is invalid for atomic vectors"},{"path":"https://github.com/Holdols/genstats/reference/GWAS.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes casusal SNP's — GWAS","title":"Computes casusal SNP's — GWAS","text":"function heavily build onto bigstatsr::big_univLinReg. documentation check  https://privefl.github.io/bigstatsr/reference/big_univLinReg.html","code":""},{"path":"https://github.com/Holdols/genstats/reference/GWAS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes casusal SNP's — GWAS","text":"","code":"GWAS(G, y, p, logreg = FALSE, ncores = 1)"},{"path":"https://github.com/Holdols/genstats/reference/GWAS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computes casusal SNP's — GWAS","text":"G file backed matrix SNP data. y vector containing targets position. p significance level. logreg TRUE logistic regression, else Linear regression. ncores Amount cores use.","code":""},{"path":"https://github.com/Holdols/genstats/reference/GWAS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computes casusal SNP's — GWAS","text":"matrix containing: slopes regression standard errors slope t-scores associated slope. p-values slope binary vector saying position causal given p","code":""},{"path":"https://github.com/Holdols/genstats/reference/G_func_fam.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate SNP for all subjects and liabilities for family — G_func_fam","title":"Simulate SNP for all subjects and liabilities for family — G_func_fam","text":"function creates bigsnpr object, saves rds file. fills file backed matrix generated geneotypes subject. function also returns genetic liabilities parents subject since parents genotypes saved. liabilitiesfor parents therefore calculated loop genotype simulated.","code":""},{"path":"https://github.com/Holdols/genstats/reference/G_func_fam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate SNP for all subjects and liabilities for family — G_func_fam","text":"","code":"G_func_fam(   filename,   beta,   MAF,   N = 1e+05,   M = 1e+05,   n_sib = 0,   block_size = 1000 )"},{"path":"https://github.com/Holdols/genstats/reference/G_func_fam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate SNP for all subjects and liabilities for family — G_func_fam","text":"filename Filename file backed matrix(FBM) rds file. beta vector containing casual effect SNP. MAF vector containing minor allele frequencies. N Amount subjects. M Amount SNPs. block_size Size FBM processed iteration. n_sibs Amount siblings.","code":""},{"path":"https://github.com/Holdols/genstats/reference/G_func_fam.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate SNP for all subjects and liabilities for family — G_func_fam","text":"List containing simulated SNPs subjects FBM family's liabilities tibble.","code":""},{"path":"https://github.com/Holdols/genstats/reference/G_func_simple.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate SNP for all subjects — G_func_simple","title":"Simulate SNP for all subjects — G_func_simple","text":"function creates bigsnpr object, saves rds file. fills file backed matrix generated geneotypes subject.","code":""},{"path":"https://github.com/Holdols/genstats/reference/G_func_simple.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate SNP for all subjects — G_func_simple","text":"","code":"G_func_simple(filename, MAF, N = 1e+05, M = 1e+05, block_size = 1000)"},{"path":"https://github.com/Holdols/genstats/reference/G_func_simple.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate SNP for all subjects — G_func_simple","text":"filename Filename file backed matrix(FBM) rds file. MAF vector containing minor allele frequencies. N Amount subjects. block_size Size FBM processed iteration. n_sib Amount siblings.","code":""},{"path":"https://github.com/Holdols/genstats/reference/G_func_simple.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate SNP for all subjects — G_func_simple","text":"FBM containing simulated SNPs subjects.","code":""},{"path":"https://github.com/Holdols/genstats/reference/liabilities_func_fam.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate genetic liabilities and simulate enviromental liabilities for subject and family — liabilities_func_fam","title":"Calculate genetic liabilities and simulate enviromental liabilities for subject and family — liabilities_func_fam","text":"Helper function gen_sim()","code":""},{"path":"https://github.com/Holdols/genstats/reference/liabilities_func_fam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate genetic liabilities and simulate enviromental liabilities for subject and family — liabilities_func_fam","text":"","code":"liabilities_func_fam(   G,   beta,   MAF,   liab,   N = 1e+05,   n_sib = 0,   K = 0.05,   h2 = 0.5,   block_size = 1000 )"},{"path":"https://github.com/Holdols/genstats/reference/liabilities_func_fam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate genetic liabilities and simulate enviromental liabilities for subject and family — liabilities_func_fam","text":"G File backed matrix containing SNP data. beta vector containing casual effect SNP. MAF vector containing minor allele frequencies. liab tibble containing genetic liabilities subject's family members. N Amount subjects. n_sib Amount siblings. block_size Size FBM processed iteration. h_2 heritability trait.","code":""},{"path":"https://github.com/Holdols/genstats/reference/liabilities_func_fam.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate genetic liabilities and simulate enviromental liabilities for subject and family — liabilities_func_fam","text":"tibble containing genetic full liability family member.","code":""},{"path":"https://github.com/Holdols/genstats/reference/liabilities_func_simple.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate genetic liabilities and simulate enviromental liabilities for subject — liabilities_func_simple","title":"Calculate genetic liabilities and simulate enviromental liabilities for subject — liabilities_func_simple","text":"Helper function gen_sim()","code":""},{"path":"https://github.com/Holdols/genstats/reference/liabilities_func_simple.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate genetic liabilities and simulate enviromental liabilities for subject — liabilities_func_simple","text":"","code":"liabilities_func_simple(   G,   beta,   MAF,   N = 1e+05,   K = 0.05,   h2 = 0.5,   block_size = 1000 )"},{"path":"https://github.com/Holdols/genstats/reference/liabilities_func_simple.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate genetic liabilities and simulate enviromental liabilities for subject — liabilities_func_simple","text":"G File backed matrix containing SNP data. beta vector containing casual effect SNP. MAF vector containing minor allele frequencies. N Amount subjects. h2 heritability trait. block_size Size FBM processed iteration.","code":""},{"path":"https://github.com/Holdols/genstats/reference/liabilities_func_simple.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate genetic liabilities and simulate enviromental liabilities for subject — liabilities_func_simple","text":"tibble containing genetic full liability subject.","code":""},{"path":"https://github.com/Holdols/genstats/reference/LTFH.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimates liabilities for every subject — LTFH","title":"Estimates liabilities for every subject — LTFH","text":"function takes output gen_sim uses phenotypes estimate genetic liability subject. function estimated liability configuration phenotypes joins values existing dataframe. Subjects configuration therefore estimated genetic liability.","code":""},{"path":"https://github.com/Holdols/genstats/reference/LTFH.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimates liabilities for every subject — LTFH","text":"","code":"LTFH(data, n_sib = 0, K = 0.05, h2 = 0.5)"},{"path":"https://github.com/Holdols/genstats/reference/LTFH.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimates liabilities for every subject — LTFH","text":"data List generated gen_sim. n_sib Amount siblings. K prevalance trait. h2 heritability trait.","code":""},{"path":"https://github.com/Holdols/genstats/reference/LTFH.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimates liabilities for every subject — LTFH","text":"Tibble containing data$fam estimated liabilities.","code":""},{"path":"https://github.com/Holdols/genstats/reference/LTFH_notrunc.html","id":null,"dir":"Reference","previous_headings":"","what":"Create LTFH estimations without truncation. — LTFH_notrunc","title":"Create LTFH estimations without truncation. — LTFH_notrunc","text":"Create LTFH estimations without truncation.","code":""},{"path":"https://github.com/Holdols/genstats/reference/LTFH_notrunc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create LTFH estimations without truncation. — LTFH_notrunc","text":"","code":"LTFH_notrunc(covmat, N = 3000, K = 0.05, s_val = 0)"},{"path":"https://github.com/Holdols/genstats/reference/LTFH_notrunc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create LTFH estimations without truncation. — LTFH_notrunc","text":"covmat covariance matrix N Amount rows matrix estimations saved K prevalance trait s_val starting value estimates","code":""},{"path":"https://github.com/Holdols/genstats/reference/LTFH_notrunc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create LTFH estimations without truncation. — LTFH_notrunc","text":"vector containing LTFH estimate liabilities form c(genetic_liability_subject, liability_subject, liability_parent1, liability_parent2, liability_sibling1, ..., liability_siblingN)","code":""},{"path":"https://github.com/Holdols/genstats/reference/LTFH_notrunc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create LTFH estimations without truncation. — LTFH_notrunc","text":"","code":"LTFH(get_cov(0.5, n_sib = 1)) #> Error in LTFH(get_cov(0.5, n_sib = 1)): argument \"phenos\" is missing, with no default"},{"path":"https://github.com/Holdols/genstats/reference/LTFH_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plots estimated liabilities agianst true liabilities — LTFH_plot","title":"Plots estimated liabilities agianst true liabilities — LTFH_plot","text":"Plots estimated liabilities agianst true liabilities","code":""},{"path":"https://github.com/Holdols/genstats/reference/LTFH_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plots estimated liabilities agianst true liabilities — LTFH_plot","text":"","code":"LTFH_plot(LTFH_est)"},{"path":"https://github.com/Holdols/genstats/reference/LTFH_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plots estimated liabilities agianst true liabilities — LTFH_plot","text":"LTFH_est Output LTFH.","code":""},{"path":"https://github.com/Holdols/genstats/reference/LTFH_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plots estimated liabilities agianst true liabilities — LTFH_plot","text":"Plot estimated liabilities agianst true liabilities.","code":""},{"path":"https://github.com/Holdols/genstats/reference/MAF_func.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate vector containing minor allele frequencies (MAF) — MAF_func","title":"Simulate vector containing minor allele frequencies (MAF) — MAF_func","text":"function simulates minor allele frequencies SNP. Minor allele frequencies independent uniformly distributed interval \\([0.01, 0.49]\\).","code":""},{"path":"https://github.com/Holdols/genstats/reference/MAF_func.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate vector containing minor allele frequencies (MAF) — MAF_func","text":"","code":"MAF_func(M = 1e+05)"},{"path":"https://github.com/Holdols/genstats/reference/MAF_func.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate vector containing minor allele frequencies (MAF) — MAF_func","text":"M Amount SNPs.","code":""},{"path":"https://github.com/Holdols/genstats/reference/MAF_func.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate vector containing minor allele frequencies (MAF) — MAF_func","text":"Vector containing minor allele frequencies (MAF).","code":""},{"path":"https://github.com/Holdols/genstats/reference/manhattan_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Creates a manhattan plot — manhattan_plot","title":"Creates a manhattan plot — manhattan_plot","text":"function returns manhattan plot vizualises ","code":""},{"path":"https://github.com/Holdols/genstats/reference/manhattan_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Creates a manhattan plot — manhattan_plot","text":"","code":"manhattan_plot(gwas_summary, beta, thresholds = FALSE)"},{"path":"https://github.com/Holdols/genstats/reference/manhattan_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Creates a manhattan plot — manhattan_plot","text":"gwas_summary Output GWAS. beta vector containing actual casual effect SNP.","code":""},{"path":"https://github.com/Holdols/genstats/reference/manhattan_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Creates a manhattan plot — manhattan_plot","text":"manhattan plot.","code":""},{"path":"https://github.com/Holdols/genstats/reference/normalized_prod.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize file backed matrix (FBM) — normalized_prod","title":"Normalize file backed matrix (FBM) — normalized_prod","text":"Helper function gen_sim()","code":""},{"path":"https://github.com/Holdols/genstats/reference/normalized_prod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize file backed matrix (FBM) — normalized_prod","text":"","code":"normalized_prod(Gx, beta, MAF)"},{"path":"https://github.com/Holdols/genstats/reference/normalized_prod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize file backed matrix (FBM) — normalized_prod","text":"Gx Subset FBM containing SNP data. beta vector containing casual effect SNP. MAF vector containing minor allele frequencies.","code":""},{"path":"https://github.com/Holdols/genstats/reference/normalized_prod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize file backed matrix (FBM) — normalized_prod","text":"vector containing genetic liability Gx.","code":""},{"path":"https://github.com/Holdols/genstats/reference/no_trunc_estimate.html","id":null,"dir":"Reference","previous_headings":"","what":"Returns random value from normal distribution. — no_trunc_estimate","title":"Returns random value from normal distribution. — no_trunc_estimate","text":"Helper function gibb_sampl()","code":""},{"path":"https://github.com/Holdols/genstats/reference/no_trunc_estimate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Returns random value from normal distribution. — no_trunc_estimate","text":"","code":"no_trunc_estimate(mu, sigma)"},{"path":"https://github.com/Holdols/genstats/reference/no_trunc_estimate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Returns random value from normal distribution. — no_trunc_estimate","text":"mu mean. sigma variance.","code":""},{"path":"https://github.com/Holdols/genstats/reference/no_trunc_estimate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Returns random value from normal distribution. — no_trunc_estimate","text":"Random value normal distribution.","code":""},{"path":"https://github.com/Holdols/genstats/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://github.com/Holdols/genstats/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://github.com/Holdols/genstats/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://github.com/Holdols/genstats/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://github.com/Holdols/genstats/reference/plot_gibbs.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the convergence of gibb_sampl — plot_gibbs","title":"Plot the convergence of gibb_sampl — plot_gibbs","text":"Plot convergence gibb_sampl","code":""},{"path":"https://github.com/Holdols/genstats/reference/plot_gibbs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the convergence of gibb_sampl — plot_gibbs","text":"","code":"plot_gibbs(ests)"},{"path":"https://github.com/Holdols/genstats/reference/plot_gibbs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the convergence of gibb_sampl — plot_gibbs","text":"ests Output gibb_sampl all_est=TRUE.","code":""},{"path":"https://github.com/Holdols/genstats/reference/plot_gibbs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the convergence of gibb_sampl — plot_gibbs","text":"Plots showing values iteration.","code":""},{"path":"https://github.com/Holdols/genstats/reference/power_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Creates a power plot — power_plot","title":"Creates a power plot — power_plot","text":"Creates power plot","code":""},{"path":"https://github.com/Holdols/genstats/reference/power_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Creates a power plot — power_plot","text":"","code":"power_plot(gwas_summary, beta)"},{"path":"https://github.com/Holdols/genstats/reference/power_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Creates a power plot — power_plot","text":"gwas_summary Output GWAS. beta vector containing actual casual effect SNP.","code":""},{"path":"https://github.com/Holdols/genstats/reference/power_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Creates a power plot — power_plot","text":"power plot.","code":""},{"path":"https://github.com/Holdols/genstats/reference/prediction.html","id":null,"dir":"Reference","previous_headings":"","what":"Predicts the probability of having the given trait — prediction","title":"Predicts the probability of having the given trait — prediction","text":"function take outcome pred_model() use find estimated probability subject trait/sickness.","code":""},{"path":"https://github.com/Holdols/genstats/reference/prediction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predicts the probability of having the given trait — prediction","text":"","code":"prediction(test_data, model, thr)"},{"path":"https://github.com/Holdols/genstats/reference/prediction.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predicts the probability of having the given trait — prediction","text":"test_data List generated gen_sim. model Output pred_model(). thr Treshold p-value used calculating PRS.","code":""},{"path":"https://github.com/Holdols/genstats/reference/prediction.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predicts the probability of having the given trait — prediction","text":"Vector estimated probabilities.","code":""},{"path":"https://github.com/Holdols/genstats/reference/pred_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Trains model on train data given the target vector. — pred_model","title":"Trains model on train data given the target vector. — pred_model","text":"funcion first use GWAS find casual effect SNP. calculate PRS use linear logistic regression estimate phenotypes. final output list containing model GWAS regression. can used predict phenotypes test data.","code":""},{"path":"https://github.com/Holdols/genstats/reference/pred_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trains model on train data given the target vector. — pred_model","text":"","code":"pred_model(train_data, y, thr, LogReg_g = FALSE, LogReg_prs = FALSE)"},{"path":"https://github.com/Holdols/genstats/reference/pred_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trains model on train data given the target vector. — pred_model","text":"train_data List generated gen_sim. y target vector. either estimated liabilities LTFH phenotypes. thr Treshold p-value used calculating PRS. LogReg Boolean indicating logistic regression used estimate casual effect.","code":""},{"path":"https://github.com/Holdols/genstats/reference/pred_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Trains model on train data given the target vector. — pred_model","text":"List containing output GWAS Linear regression PRS phenotype subject. ","code":""},{"path":"https://github.com/Holdols/genstats/reference/PRS_cross.html","id":null,"dir":"Reference","previous_headings":"","what":"Uses cross validation to train and estimate PRS for each fold — PRS_cross","title":"Uses cross validation to train and estimate PRS for each fold — PRS_cross","text":"funcion returns list PRS estimated fold threshold. function train remaining data test fold. function uses GWAS estimate casual SNP uses find PRS. list containing matrices column threshold. interpretation treshold given effect SNP included -log10 transformation p-value smaller threshold. Fx. value 3 correspond p value smaller 0.001.","code":""},{"path":"https://github.com/Holdols/genstats/reference/PRS_cross.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Uses cross validation to train and estimate PRS for each fold — PRS_cross","text":"","code":"PRS_cross(data, y01, cross_folds, LogReg = FALSE)"},{"path":"https://github.com/Holdols/genstats/reference/PRS_cross.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Uses cross validation to train and estimate PRS for each fold — PRS_cross","text":"data List generated gen_sim. cross_folds Number folds cross validation. LogReg Boolean indicating logistic regression used estimate casual effect. y target vector. either estimated liabilities LTFH phenotypes.","code":""},{"path":"https://github.com/Holdols/genstats/reference/PRS_cross.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Uses cross validation to train and estimate PRS for each fold — PRS_cross","text":"List estimated PRS fold.","code":""},{"path":"https://github.com/Holdols/genstats/reference/prs_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Creates evaluation plot for MSE, AUC or r squared — prs_plot","title":"Creates evaluation plot for MSE, AUC or r squared — prs_plot","text":"function creates one plot fold PRS. plot show chosen method evaluated threshold. Lastly function plot mean threshold. function can used find threshold. p-values best can describe data.","code":""},{"path":"https://github.com/Holdols/genstats/reference/prs_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Creates evaluation plot for MSE, AUC or r squared — prs_plot","text":"","code":"prs_plot(PRS, data, method = \"MSE\")"},{"path":"https://github.com/Holdols/genstats/reference/prs_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Creates evaluation plot for MSE, AUC or r squared — prs_plot","text":"PRS Output PRS_cross. data List generated gen_sim. method Indicates method fold evaluated .","code":""},{"path":"https://github.com/Holdols/genstats/reference/prs_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Creates evaluation plot for MSE, AUC or r squared — prs_plot","text":"Plots method threshold fold mean folds.","code":""},{"path":"https://github.com/Holdols/genstats/reference/scatter_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plots true causal effects agianst estimated effects — scatter_plot","title":"Plots true causal effects agianst estimated effects — scatter_plot","text":"Plots true causal effects agianst estimated effects","code":""},{"path":"https://github.com/Holdols/genstats/reference/scatter_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plots true causal effects agianst estimated effects — scatter_plot","text":"","code":"scatter_plot(gwas_summary, beta)"},{"path":"https://github.com/Holdols/genstats/reference/scatter_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plots true causal effects agianst estimated effects — scatter_plot","text":"gwas_summary Output GWAS. beta vector containing actual casual effect SNP.","code":""},{"path":"https://github.com/Holdols/genstats/reference/scatter_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plots true causal effects agianst estimated effects — scatter_plot","text":"Scatterplot true causal effects agianst estimated effects","code":""},{"path":"https://github.com/Holdols/genstats/reference/sim_fam.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate block of snps for whole family — sim_fam","title":"Simulate block of snps for whole family — sim_fam","text":"Helper function gen_sim()","code":""},{"path":"https://github.com/Holdols/genstats/reference/sim_fam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate block of snps for whole family — sim_fam","text":"","code":"sim_fam(i, G, beta, MAF, N = 1e+05, n_sib = 0, block_size = 1000)"},{"path":"https://github.com/Holdols/genstats/reference/sim_fam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate block of snps for whole family — sim_fam","text":"Iteration loop. G Empty file backed matrix(FBM). beta vector containing casual effect SNP. MAF vector containing minor allele frequencies. N Amount subjects. block_size Size FBM processed iteration. n_sibs Amount siblings.","code":""},{"path":"https://github.com/Holdols/genstats/reference/sim_fam.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate block of snps for whole family — sim_fam","text":"Tibble simulated SNPs subject family's liabilities.","code":""},{"path":"https://github.com/Holdols/genstats/reference/trunc_estimate.html","id":null,"dir":"Reference","previous_headings":"","what":"Returns truncated random value from normal distribution. — trunc_estimate","title":"Returns truncated random value from normal distribution. — trunc_estimate","text":"Helper function gibb_sampl()","code":""},{"path":"https://github.com/Holdols/genstats/reference/trunc_estimate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Returns truncated random value from normal distribution. — trunc_estimate","text":"","code":"trunc_estimate(j, phenos, K = 0.05, mu, sigma)"},{"path":"https://github.com/Holdols/genstats/reference/trunc_estimate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Returns truncated random value from normal distribution. — trunc_estimate","text":"j Index familymember. phenos binary vector containing phenotype family member form c(p_subject, p_parent1, p_parent2, p_sibling1, ... ,p_siblingN) p_familymember binary value (1 2). K prevalance trait. mu mean. sigma variance.","code":""},{"path":"https://github.com/Holdols/genstats/reference/trunc_estimate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Returns truncated random value from normal distribution. — trunc_estimate","text":"Truncated random value normal distribution.","code":""},{"path":"https://github.com/Holdols/genstats/reference/y_func.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate phenotypes — y_func","title":"Calculate phenotypes — y_func","text":"Calculate phenotypes","code":""},{"path":"https://github.com/Holdols/genstats/reference/y_func.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate phenotypes — y_func","text":"","code":"y_func(l_e_0, l_g_0, K = 0.05)"},{"path":"https://github.com/Holdols/genstats/reference/y_func.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate phenotypes — y_func","text":"l_e_0 vector containing enviromental liabilities l_g_0 vector containing genetic liabilities k prevalance trait","code":""},{"path":"https://github.com/Holdols/genstats/reference/y_func.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate phenotypes — y_func","text":"binary vector contatining phenotypes","code":""}]
